<!DOCTYPE html>
<html>
  <head>
    <!-- meta information -->
<meta charset="utf-8">
<meta name="description" 
      content="Here's the `rgbif` screencast!Follow along below in your favorite R client.  I'll be using the RStudio IDE.rgbif scre..." >
<meta name="author" content="Scott Chamberlain">

<!-- Enable responsiveness on mobile devices-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<!-- title -->
<title>rgbif &middot; rOpenSci</title>

<!-- icons -->
<link rel="shortcut icon" href="/screencasts/public/images/ropensci_favicon.ico" />

<!-- stylesheets -->
<link rel="stylesheet" href="/screencasts/public/css/responsive.gs.12col.css">
<link rel="stylesheet" href="/screencasts/public/css/animate.min.css">
<link rel="stylesheet" href="/screencasts/public/css/main.css">

<!-- Google fonts -->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,400italic&subset=latin-ext">



<!-- feed links -->
<link rel="alternate" href="http://ropensci.github.io/screencasts/feed.xml" type="application/rss+xml" title="">

  </head>
  <body>
    <div class="container azul">
      <header class="top row gutters">
        <div class="col span_2 center">
          <!-- TODO: add baseurl to the logo link -->
          <a href="http://ropensci.github.io/screencasts" id="logo" title="rOpenSci"
             style="background-image: url(/screencasts/public/images/ropensci_small.png);"></a>
        </div>
        <nav class="col span_10 top-navbar">
  
  <a href="/screencasts/" title="Home"
     >Home</a>
  
  <a href="/screencasts/about/" title="About"
     >About</a>
  
</nav>

      </header>

      <article class="single row gutters">
  <!-- <time class="published" datetime="2015-05-06">06 May 2015</time> -->
  <h2>rgbif</h2>

  <p>Here&#39;s the <code>rgbif</code> screencast!</p>

<p>Follow along below in your favorite R client.  I&#39;ll be using the RStudio IDE.</p>

<iframe src="//player.vimeo.com/video/127119010" width="600" height="381" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>

<h1>rgbif screencast</h1>

<h2>Intro</h2>

<blockquote>
<p>Hi, I&#39;m Scott Chamberlain</p>

<p>In this screencast, I&#39;ll do a brief intoduction to the <code>rgbif</code> package - an <code>R</code> client for the Global Biodiversity Information Facility (GBIF)</p>

<p>rgbif allows you to get species occurrence data from GBIF</p>
</blockquote>

<p><img src="../public/images/gbif.png" alt="gbif_site"></p>

<h2>Installation and load</h2>
<div class="highlight"><pre><code class="language-r" data-lang="r">install.packages<span class="p">(</span><span class="s">&quot;rgbif&quot;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span><span class="s">&quot;rgbif&quot;</span><span class="p">)</span>
</code></pre></div>
<h2>Get number of occurrences</h2>

<blockquote>
<p>Search by type of record, all observational in this case</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_count<span class="p">(</span>basisOfRecord <span class="o">=</span> <span class="s">&#39;OBSERVATION&#39;</span><span class="p">)</span>
<span class="c1">#&gt; [1] 114413835</span>
</code></pre></div>
<blockquote>
<p>Records for <strong>Puma concolor</strong> with lat/long data (georeferenced) only. Note that <code>hasCoordinate</code> in <code>occ_search()</code> is the same as <code>georeferenced</code> in <code>occ_count()</code>.</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_count<span class="p">(</span>taxonKey <span class="o">=</span> <span class="m">2435099</span><span class="p">,</span> georeferenced <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="c1">#&gt; [1] 2847</span>
</code></pre></div>
<blockquote>
<p>All georeferenced records in GBIF</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_count<span class="p">(</span>georeferenced <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
<span class="c1">#&gt; [1] 465184716</span>
</code></pre></div>
<blockquote>
<p>Records from Denmark only</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="p">(</span>denmark_code <span class="o">&lt;-</span> isocodes<span class="p">[</span><span class="kp">grep</span><span class="p">(</span><span class="s">&quot;Denmark&quot;</span><span class="p">,</span> isocodes<span class="o">$</span>name<span class="p">),</span> <span class="s">&quot;code&quot;</span><span class="p">])</span>
<span class="c1">#&gt; [1] &quot;DK&quot;</span>
occ_count<span class="p">(</span>country <span class="o">=</span> denmark_code<span class="p">)</span>
<span class="c1">#&gt; [1] 9614891</span>
</code></pre></div>
<h2>Search for taxonomic names</h2>

<blockquote>
<p>Four taxononomic names functions</p>
</blockquote>

<ul>
<li><code>name_backbone()</code></li>
<li><code>name_lookup()</code></li>
<li><code>name_usage()</code></li>
<li><code>name_suggest()</code></li>
</ul>

<blockquote>
<p><code>name_backbone()</code> searches against the GBIF backbone taxonomy</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">name_backbone<span class="p">(</span>name <span class="o">=</span> <span class="s">&#39;Helianthus&#39;</span><span class="p">,</span> rank <span class="o">=</span> <span class="s">&#39;genus&#39;</span><span class="p">,</span> kingdom <span class="o">=</span> <span class="s">&#39;plants&#39;</span><span class="p">)</span>
<span class="c1">#&gt; $usageKey</span>
<span class="c1">#&gt; [1] 3119134</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $scientificName</span>
<span class="c1">#&gt; [1] &quot;Helianthus L.&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $canonicalName</span>
<span class="c1">#&gt; [1] &quot;Helianthus&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $rank</span>
<span class="c1">#&gt; [1] &quot;GENUS&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $status</span>
<span class="c1">#&gt; [1] &quot;ACCEPTED&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $confidence</span>
<span class="c1">#&gt; [1] 97</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $matchType</span>
<span class="c1">#&gt; [1] &quot;EXACT&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $kingdom</span>
<span class="c1">#&gt; [1] &quot;Plantae&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $phylum</span>
<span class="c1">#&gt; [1] &quot;Magnoliophyta&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $order</span>
<span class="c1">#&gt; [1] &quot;Asterales&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $family</span>
<span class="c1">#&gt; [1] &quot;Asteraceae&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $genus</span>
<span class="c1">#&gt; [1] &quot;Helianthus&quot;</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $kingdomKey</span>
<span class="c1">#&gt; [1] 6</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $phylumKey</span>
<span class="c1">#&gt; [1] 49</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $classKey</span>
<span class="c1">#&gt; [1] 220</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $orderKey</span>
<span class="c1">#&gt; [1] 414</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $familyKey</span>
<span class="c1">#&gt; [1] 3065</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $genusKey</span>
<span class="c1">#&gt; [1] 3119134</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $synonym</span>
<span class="c1">#&gt; [1] FALSE</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $class</span>
<span class="c1">#&gt; [1] &quot;Magnoliopsida&quot;</span>
</code></pre></div>
<blockquote>
<p><code>name_lookup()</code> does full text search of name usages covering the scientific and vernacular name, the species description, distribution and the entire classification across all name usages of all or some checklists</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">out <span class="o">&lt;-</span> name_lookup<span class="p">(</span>query <span class="o">=</span> <span class="s">&#39;mammalia&#39;</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kp">names</span><span class="p">(</span>out<span class="p">)</span>
<span class="c1">#&gt; [1] &quot;meta&quot;        &quot;data&quot;        &quot;facets&quot;      &quot;hierarchies&quot; &quot;names&quot;</span>
</code></pre></div><div class="highlight"><pre><code class="language-r" data-lang="r">out<span class="o">$</span>meta
<span class="c1">#&gt;   offset limit endOfRecords  count</span>
<span class="c1">#&gt; 1      0   100        FALSE 119432</span>
</code></pre></div><div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kp">head</span><span class="p">(</span>out<span class="o">$</span>data<span class="p">,</span> n <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
<span class="c1">#&gt;         key          scientificName                           datasetKey</span>
<span class="c1">#&gt; 1 125798198                Mammalia 16c3f9cb-4b19-4553-ac8e-ebb90003aa02</span>
<span class="c1">#&gt; 2 116665331 Mammalia Linnaeus, 1758 cbb6498e-8927-405a-916b-576d00a6289b</span>
<span class="c1">#&gt;   nubKey parentKey   parent   phylum phylumKey  classKey canonicalName</span>
<span class="c1">#&gt; 1    359 137006861 Chordata Chordata 137006861 125798198      Mammalia</span>
<span class="c1">#&gt; 2    359 143035196 Chordata Chordata 143035196 116665331      Mammalia</span>
<span class="c1">#&gt;       authorship   nameType  rank numDescendants numOccurrences taxonID</span>
<span class="c1">#&gt; 1                WELLFORMED CLASS              2              0 2621711</span>
<span class="c1">#&gt; 2 Linnaeus, 1758 WELLFORMED CLASS           1193              0   18838</span>
<span class="c1">#&gt;   extinct habitats nomenclaturalStatus threatStatuses synonym    class</span>
<span class="c1">#&gt; 1    TRUE     &lt;NA&gt;                  NA             NA   FALSE Mammalia</span>
<span class="c1">#&gt; 2      NA     &lt;NA&gt;                  NA             NA   FALSE Mammalia</span>
<span class="c1">#&gt;    kingdom kingdomKey publishedIn accordingTo taxonomicStatus order</span>
<span class="c1">#&gt; 1     &lt;NA&gt;         NA        &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;  &lt;NA&gt;</span>
<span class="c1">#&gt; 2 Animalia  116630539        &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;  &lt;NA&gt;</span>
<span class="c1">#&gt;   orderKey species speciesKey acceptedKey accepted family familyKey genus</span>
<span class="c1">#&gt; 1       NA    &lt;NA&gt;         NA          NA     &lt;NA&gt;   &lt;NA&gt;        NA  &lt;NA&gt;</span>
<span class="c1">#&gt; 2       NA    &lt;NA&gt;         NA          NA     &lt;NA&gt;   &lt;NA&gt;        NA  &lt;NA&gt;</span>
<span class="c1">#&gt;   genusKey</span>
<span class="c1">#&gt; 1       NA</span>
<span class="c1">#&gt; 2       NA</span>
</code></pre></div>
<h2>Search for occurrences</h2>

<blockquote>
<p>By default <code>occ_search()</code> returns a <code>dplyr</code> like output summary in which the data printed expands based on how much data is returned, and the size of your window. You can search in a variety of ways, including by scientific name:</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_search<span class="p">(</span>scientificName <span class="o">=</span> <span class="s">&quot;Ursus americanus&quot;</span><span class="p">,</span> limit <span class="o">=</span> <span class="m">20</span><span class="p">)</span>
<span class="c1">#&gt; Records found [7202] </span>
<span class="c1">#&gt; Records returned [20] </span>
<span class="c1">#&gt; No. unique hierarchies [1] </span>
<span class="c1">#&gt; No. media records [19] </span>
<span class="c1">#&gt; Args [scientificName=Ursus americanus, limit=20, offset=0, fields=all] </span>
<span class="c1">#&gt; First 10 rows of data</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;                name        key decimalLatitude decimalLongitude</span>
<span class="c1">#&gt; 1  Ursus americanus 1065588899        35.73304        -82.42028</span>
<span class="c1">#&gt; 2  Ursus americanus 1065590124        38.36662        -79.68283</span>
<span class="c1">#&gt; 3  Ursus americanus 1065611122        43.94883        -72.77432</span>
<span class="c1">#&gt; 4  Ursus americanus  786016809              NA               NA</span>
<span class="c1">#&gt; 5  Ursus americanus  891034709        29.23322       -103.29468</span>
<span class="c1">#&gt; 6  Ursus americanus  891041363        29.28284       -103.28908</span>
<span class="c1">#&gt; 7  Ursus americanus 1024328693        34.20990       -118.14681</span>
<span class="c1">#&gt; 8  Ursus americanus  891045574        43.73511        -72.52534</span>
<span class="c1">#&gt; 9  Ursus americanus 1050834838        33.11070       -107.70675</span>
<span class="c1">#&gt; 10 Ursus americanus  891056344        29.27444       -103.31536</span>
<span class="c1">#&gt; ..              ...        ...             ...              ...</span>
<span class="c1">#&gt; Variables not shown: issues (chr), datasetKey (chr), publishingOrgKey</span>
<span class="c1">#&gt;      (chr), publishingCountry (chr), protocol (chr), lastCrawled (chr),</span>
<span class="c1">#&gt;      lastParsed (chr), extensions (chr), basisOfRecord (chr), taxonKey</span>
<span class="c1">#&gt;      (int), kingdomKey (int), phylumKey (int), classKey (int), orderKey</span>
<span class="c1">#&gt;      (int), familyKey (int), genusKey (int), speciesKey (int),</span>
<span class="c1">#&gt;      scientificName (chr), kingdom (chr), phylum (chr), order (chr),</span>
<span class="c1">#&gt;      family (chr), genus (chr), species (chr), genericName (chr),</span>
<span class="c1">#&gt;      specificEpithet (chr), taxonRank (chr), dateIdentified (chr), year</span>
<span class="c1">#&gt;      (int), month (int), day (int), eventDate (chr), modified (chr),</span>
<span class="c1">#&gt;      lastInterpreted (chr), references (chr), identifiers (chr), facts</span>
<span class="c1">#&gt;      (chr), relations (chr), geodeticDatum (chr), class (chr), countryCode</span>
<span class="c1">#&gt;      (chr), country (chr), verbatimEventDate (chr), verbatimLocality</span>
<span class="c1">#&gt;      (chr), http...unknown.org.occurrenceDetails (chr), rights (chr),</span>
<span class="c1">#&gt;      rightsHolder (chr), occurrenceID (chr), collectionCode (chr), taxonID</span>
<span class="c1">#&gt;      (chr), gbifID (chr), institutionCode (chr), catalogNumber (chr),</span>
<span class="c1">#&gt;      datasetName (chr), recordedBy (chr), eventTime (chr), identifier</span>
<span class="c1">#&gt;      (chr), identificationID (chr), occurrenceRemarks (chr), sex (chr),</span>
<span class="c1">#&gt;      establishmentMeans (chr), preparations (chr), recordNumber (chr),</span>
<span class="c1">#&gt;      nomenclaturalCode (chr), higherClassification (chr), type (chr),</span>
<span class="c1">#&gt;      vernacularName (chr), accessRights (chr), occurrenceStatus (chr),</span>
<span class="c1">#&gt;      language (chr), disposition (chr), infraspecificEpithet (chr),</span>
<span class="c1">#&gt;      lifeStage (chr), elevation (dbl), elevationAccuracy (dbl), continent</span>
<span class="c1">#&gt;      (chr), stateProvince (chr), georeferencedDate (chr), institutionID</span>
<span class="c1">#&gt;      (chr), higherGeography (chr), identifiedBy (chr), georeferenceSources</span>
<span class="c1">#&gt;      (chr), identificationVerificationStatus (chr), samplingProtocol</span>
<span class="c1">#&gt;      (chr), endDayOfYear (chr), otherCatalogNumbers (chr),</span>
<span class="c1">#&gt;      georeferenceVerificationStatus (chr), individualID (chr),</span>
<span class="c1">#&gt;      locationAccordingTo (chr), previousIdentifications (chr),</span>
<span class="c1">#&gt;      verbatimCoordinateSystem (chr), georeferenceProtocol (chr),</span>
<span class="c1">#&gt;      identificationQualifier (chr), dynamicProperties (chr), county (chr),</span>
<span class="c1">#&gt;      locality (chr), georeferencedBy (chr)</span>
</code></pre></div>
<blockquote>
<p>Or to be more precise, you can search for names first, make sure you have the right name, then pass the GBIF key to the <code>occ_search()</code> function:</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">key <span class="o">&lt;-</span> name_suggest<span class="p">(</span>q <span class="o">=</span> <span class="s">&#39;Helianthus annuus&#39;</span><span class="p">,</span> rank <span class="o">=</span> <span class="s">&#39;species&#39;</span><span class="p">)</span><span class="o">$</span>key<span class="p">[</span><span class="m">1</span><span class="p">]</span>
occ_search<span class="p">(</span>taxonKey <span class="o">=</span> key<span class="p">,</span> limit <span class="o">=</span> <span class="m">20</span><span class="p">)</span>
<span class="c1">#&gt; Records found [20363] </span>
<span class="c1">#&gt; Records returned [20] </span>
<span class="c1">#&gt; No. unique hierarchies [1] </span>
<span class="c1">#&gt; No. media records [9] </span>
<span class="c1">#&gt; Args [taxonKey=3119195, limit=20, offset=0, fields=all] </span>
<span class="c1">#&gt; First 10 rows of data</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;                 name        key decimalLatitude decimalLongitude</span>
<span class="c1">#&gt; 1  Helianthus annuus  922042404        -3.28140         37.52415</span>
<span class="c1">#&gt; 2  Helianthus annuus  899948224         1.27890        103.79930</span>
<span class="c1">#&gt; 3  Helianthus annuus  891052261        24.82589        -99.58411</span>
<span class="c1">#&gt; 4  Helianthus annuus 1038317691       -43.52777        172.62544</span>
<span class="c1">#&gt; 5  Helianthus annuus  922039507        50.31402          8.52341</span>
<span class="c1">#&gt; 6  Helianthus annuus  922044332        21.27114         40.41424</span>
<span class="c1">#&gt; 7  Helianthus annuus  899970378        32.54041       -117.08731</span>
<span class="c1">#&gt; 8  Helianthus annuus 1038322459       -43.07327        172.68473</span>
<span class="c1">#&gt; 9  Helianthus annuus  998785009        44.10879          4.66839</span>
<span class="c1">#&gt; 10 Helianthus annuus  899969160        24.82901        -99.58257</span>
<span class="c1">#&gt; ..               ...        ...             ...              ...</span>
<span class="c1">#&gt; Variables not shown: issues (chr), datasetKey (chr), publishingOrgKey</span>
<span class="c1">#&gt;      (chr), publishingCountry (chr), protocol (chr), lastCrawled (chr),</span>
<span class="c1">#&gt;      lastParsed (chr), extensions (chr), basisOfRecord (chr), taxonKey</span>
<span class="c1">#&gt;      (int), kingdomKey (int), phylumKey (int), classKey (int), orderKey</span>
<span class="c1">#&gt;      (int), familyKey (int), genusKey (int), speciesKey (int),</span>
<span class="c1">#&gt;      scientificName (chr), kingdom (chr), phylum (chr), order (chr),</span>
<span class="c1">#&gt;      family (chr), genus (chr), species (chr), genericName (chr),</span>
<span class="c1">#&gt;      specificEpithet (chr), taxonRank (chr), year (int), month (int), day</span>
<span class="c1">#&gt;      (int), eventDate (chr), lastInterpreted (chr), identifiers (chr),</span>
<span class="c1">#&gt;      facts (chr), relations (chr), geodeticDatum (chr), class (chr),</span>
<span class="c1">#&gt;      countryCode (chr), country (chr), gbifID (chr), institutionCode</span>
<span class="c1">#&gt;      (chr), catalogNumber (chr), recordedBy (chr), locality (chr),</span>
<span class="c1">#&gt;      collectionCode (chr), dateIdentified (chr), modified (chr),</span>
<span class="c1">#&gt;      references (chr), verbatimEventDate (chr), verbatimLocality (chr),</span>
<span class="c1">#&gt;      http...unknown.org.occurrenceDetails (chr), rights (chr),</span>
<span class="c1">#&gt;      rightsHolder (chr), occurrenceID (chr), taxonID (chr),</span>
<span class="c1">#&gt;      occurrenceRemarks (chr), datasetName (chr), eventTime (chr),</span>
<span class="c1">#&gt;      identifier (chr), identificationID (chr), county (chr), identifiedBy</span>
<span class="c1">#&gt;      (chr), stateProvince (chr), recordNumber (chr), verbatimElevation</span>
<span class="c1">#&gt;      (chr), georeferenceSources (chr), coordinateAccuracy (dbl), elevation</span>
<span class="c1">#&gt;      (dbl), elevationAccuracy (dbl), depth (dbl), depthAccuracy (dbl),</span>
<span class="c1">#&gt;      habitat (chr), fieldNotes (chr), municipality (chr)</span>
</code></pre></div>
<blockquote>
<p>You can choose what fields to return. This isn&#39;t passed on to the API query to GBIF as they don&#39;t allow that, but we filter out the columns before we give the data back to you.</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_search<span class="p">(</span>scientificName <span class="o">=</span> <span class="s">&quot;Ursus americanus&quot;</span><span class="p">,</span> fields <span class="o">=</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> limit <span class="o">=</span> <span class="m">20</span><span class="p">)</span>
<span class="c1">#&gt; Records found [7202] </span>
<span class="c1">#&gt; Records returned [20] </span>
<span class="c1">#&gt; No. unique hierarchies [1] </span>
<span class="c1">#&gt; No. media records [19] </span>
<span class="c1">#&gt; Args [scientificName=Ursus americanus, limit=20, offset=0, fields=name] </span>
<span class="c1">#&gt; First 10 rows of data</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;                name</span>
<span class="c1">#&gt; 1  Ursus americanus</span>
<span class="c1">#&gt; 2  Ursus americanus</span>
<span class="c1">#&gt; 3  Ursus americanus</span>
<span class="c1">#&gt; 4  Ursus americanus</span>
<span class="c1">#&gt; 5  Ursus americanus</span>
<span class="c1">#&gt; 6  Ursus americanus</span>
<span class="c1">#&gt; 7  Ursus americanus</span>
<span class="c1">#&gt; 8  Ursus americanus</span>
<span class="c1">#&gt; 9  Ursus americanus</span>
<span class="c1">#&gt; 10 Ursus americanus</span>
<span class="c1">#&gt; ..              ...</span>
</code></pre></div>
<blockquote>
<p>Most parameters are vectorized, so you can pass in more than one value:</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">splist <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;Cyanocitta stelleri&#39;</span><span class="p">,</span> <span class="s">&#39;Junco hyemalis&#39;</span><span class="p">,</span> <span class="s">&#39;Aix sponsa&#39;</span><span class="p">)</span>
keys <span class="o">&lt;-</span> <span class="kp">sapply</span><span class="p">(</span>splist<span class="p">,</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> name_suggest<span class="p">(</span>x<span class="p">)</span><span class="o">$</span>key<span class="p">[</span><span class="m">1</span><span class="p">],</span> USE.NAMES <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
occ_search<span class="p">(</span>taxonKey <span class="o">=</span> keys<span class="p">,</span> limit <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
<span class="c1">#&gt; Occ. found [2482598 (355649), 2492010 (1942197), 2498387 (592079)] </span>
<span class="c1">#&gt; Occ. returned [2482598 (5), 2492010 (5), 2498387 (5)] </span>
<span class="c1">#&gt; No. unique hierarchies [2482598 (1), 2492010 (1), 2498387 (1)] </span>
<span class="c1">#&gt; No. media records [2482598 (5), 2492010 (5), 2498387 (2)] </span>
<span class="c1">#&gt; Args [taxonKey=2482598,2492010,2498387, limit=5, offset=0, fields=all] </span>
<span class="c1">#&gt; First 10 rows of data from 2482598</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;                  name        key decimalLatitude decimalLongitude</span>
<span class="c1">#&gt; 1 Cyanocitta stelleri 1052604494        37.76975        -122.4715</span>
<span class="c1">#&gt; 2 Cyanocitta stelleri 1065590449        37.50713        -122.4818</span>
<span class="c1">#&gt; 3 Cyanocitta stelleri 1065588252        36.54670        -105.1335</span>
<span class="c1">#&gt; 4 Cyanocitta stelleri 1065588311        37.26200        -122.3271</span>
<span class="c1">#&gt; 5 Cyanocitta stelleri 1065588175        39.11113        -121.3083</span>
<span class="c1">#&gt; Variables not shown: issues (chr), datasetKey (chr), publishingOrgKey</span>
<span class="c1">#&gt;      (chr), publishingCountry (chr), protocol (chr), lastCrawled (chr),</span>
<span class="c1">#&gt;      lastParsed (chr), extensions (chr), basisOfRecord (chr), taxonKey</span>
<span class="c1">#&gt;      (int), kingdomKey (int), phylumKey (int), classKey (int), orderKey</span>
<span class="c1">#&gt;      (int), familyKey (int), genusKey (int), speciesKey (int),</span>
<span class="c1">#&gt;      scientificName (chr), kingdom (chr), phylum (chr), order (chr),</span>
<span class="c1">#&gt;      family (chr), genus (chr), species (chr), genericName (chr),</span>
<span class="c1">#&gt;      specificEpithet (chr), taxonRank (chr), dateIdentified (chr), year</span>
<span class="c1">#&gt;      (int), month (int), day (int), eventDate (chr), modified (chr),</span>
<span class="c1">#&gt;      lastInterpreted (chr), references (chr), identifiers (chr), facts</span>
<span class="c1">#&gt;      (chr), relations (chr), geodeticDatum (chr), class (chr), countryCode</span>
<span class="c1">#&gt;      (chr), country (chr), verbatimEventDate (chr), verbatimLocality</span>
<span class="c1">#&gt;      (chr), http...unknown.org.occurrenceDetails (chr), rights (chr),</span>
<span class="c1">#&gt;      rightsHolder (chr), occurrenceID (chr), collectionCode (chr), taxonID</span>
<span class="c1">#&gt;      (chr), occurrenceRemarks (chr), gbifID (chr), institutionCode (chr),</span>
<span class="c1">#&gt;      catalogNumber (chr), datasetName (chr), recordedBy (chr), eventTime</span>
<span class="c1">#&gt;      (chr), identifier (chr), identificationID (chr)</span>
</code></pre></div>
<h2>Single occurrence records</h2>

<blockquote>
<p>You can also get data for specific occurrences identified by occurrence key. Data is returned as a list, with slots for metadata and data</p>

<p>Just data</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_get<span class="p">(</span>key <span class="o">=</span> <span class="m">766766824</span><span class="p">,</span> <span class="kr">return</span> <span class="o">=</span> <span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="c1">#&gt;              name       key decimalLatitude decimalLongitude        issues</span>
<span class="c1">#&gt; 1 Corvus monedula 766766824         59.4568          17.9054 depunl,gass84</span>
</code></pre></div>
<blockquote>
<p>Just taxonomic hierarchy</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_get<span class="p">(</span>key <span class="o">=</span> <span class="m">766766824</span><span class="p">,</span> <span class="kr">return</span> <span class="o">=</span> <span class="s">&#39;hier&#39;</span><span class="p">)</span>
<span class="c1">#&gt;              name     key    rank</span>
<span class="c1">#&gt; 1        Animalia       1 kingdom</span>
<span class="c1">#&gt; 2        Chordata      44  phylum</span>
<span class="c1">#&gt; 3            Aves     212   class</span>
<span class="c1">#&gt; 4   Passeriformes     729   order</span>
<span class="c1">#&gt; 5        Corvidae    5235  family</span>
<span class="c1">#&gt; 6          Corvus 2482468   genus</span>
<span class="c1">#&gt; 7 Corvus monedula 2482473 species</span>
</code></pre></div>
<blockquote>
<p>All data, or leave return parameter blank</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_get<span class="p">(</span>key <span class="o">=</span> <span class="m">766766824</span><span class="p">,</span> <span class="kr">return</span> <span class="o">=</span> <span class="s">&#39;all&#39;</span><span class="p">)</span>
<span class="c1">#&gt; $hierarchy</span>
<span class="c1">#&gt;              name     key    rank</span>
<span class="c1">#&gt; 1        Animalia       1 kingdom</span>
<span class="c1">#&gt; 2        Chordata      44  phylum</span>
<span class="c1">#&gt; 3            Aves     212   class</span>
<span class="c1">#&gt; 4   Passeriformes     729   order</span>
<span class="c1">#&gt; 5        Corvidae    5235  family</span>
<span class="c1">#&gt; 6          Corvus 2482468   genus</span>
<span class="c1">#&gt; 7 Corvus monedula 2482473 species</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $media</span>
<span class="c1">#&gt; list()</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt; $data</span>
<span class="c1">#&gt;              name       key decimalLatitude decimalLongitude        issues</span>
<span class="c1">#&gt; 1 Corvus monedula 766766824         59.4568          17.9054 depunl,gass84</span>
</code></pre></div>
<blockquote>
<p>Get many occurrences. <code>occ_get</code> is vectorized</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">occ_get<span class="p">(</span>key <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">766766824</span><span class="p">,</span> <span class="m">101010</span><span class="p">,</span> <span class="m">240713150</span><span class="p">,</span> <span class="m">855998194</span><span class="p">),</span> <span class="kr">return</span> <span class="o">=</span> <span class="s">&#39;data&#39;</span><span class="p">)</span>
<span class="c1">#&gt;                  name       key decimalLatitude decimalLongitude</span>
<span class="c1">#&gt; 1     Corvus monedula 766766824         59.4568          17.9054</span>
<span class="c1">#&gt; 2 Platydoras costatus    101010         -4.3500         -70.0667</span>
<span class="c1">#&gt; 3            Pelosina 240713150        -77.5667         163.5830</span>
<span class="c1">#&gt; 4    Sciurus vulgaris 855998194         58.4068          12.0438</span>
<span class="c1">#&gt;           issues</span>
<span class="c1">#&gt; 1  depunl,gass84</span>
<span class="c1">#&gt; 2 cucdmis,gass84</span>
<span class="c1">#&gt; 3 cdround,gass84</span>
<span class="c1">#&gt; 4  depunl,gass84</span>
</code></pre></div>
<h2>Cleaning data</h2>

<blockquote>
<p>what do issues mean, can print whole table, or search for matches</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kp">head</span><span class="p">(</span>gbif_issues<span class="p">())</span>
<span class="c1">#&gt;    code                              issue</span>
<span class="c1">#&gt; 1   bri            BASIS_OF_RECORD_INVALID</span>
<span class="c1">#&gt; 2   ccm         CONTINENT_COUNTRY_MISMATCH</span>
<span class="c1">#&gt; 3   cdc CONTINENT_DERIVED_FROM_COORDINATES</span>
<span class="c1">#&gt; 4 conti                  CONTINENT_INVALID</span>
<span class="c1">#&gt; 5  cdiv                 COORDINATE_INVALID</span>
<span class="c1">#&gt; 6 cdout            COORDINATE_OUT_OF_RANGE</span>
<span class="c1">#&gt;                                                                                                    description</span>
<span class="c1">#&gt; 1 The given basis of record is impossible to interpret or seriously different from the recommended vocabulary.</span>
<span class="c1">#&gt; 2                                                       The interpreted continent and country do not match up.</span>
<span class="c1">#&gt; 3                  The interpreted continent is based on the coordinates, not the verbatim string information.</span>
<span class="c1">#&gt; 4                                                                      Uninterpretable continent values found.</span>
<span class="c1">#&gt; 5                                      Coordinate value given in some form but GBIF is unable to interpret it.</span>
<span class="c1">#&gt; 6                                        Coordinate has invalid lat/lon values out of their decimal max range.</span>
</code></pre></div>
<blockquote>
<p>compare out data to after occ_issues use</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="p">(</span>res <span class="o">&lt;-</span> occ_search<span class="p">(</span>geometry <span class="o">=</span> <span class="s">&#39;POLYGON((30.1 10.1, 10 20, 20 40, 40 40, 30.1 10.1))&#39;</span><span class="p">,</span> limit <span class="o">=</span> <span class="m">50</span><span class="p">))</span>
<span class="c1">#&gt; Records found [972494] </span>
<span class="c1">#&gt; Records returned [50] </span>
<span class="c1">#&gt; No. unique hierarchies [45] </span>
<span class="c1">#&gt; No. media records [16] </span>
<span class="c1">#&gt; Args [geometry=POLYGON((30.1 10.1, 10 20, 20 40, 40 40, 30.1 10.1)),</span>
<span class="c1">#&gt;      limit=50, offset=0, fields=all] </span>
<span class="c1">#&gt; First 10 rows of data</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;                       name        key decimalLatitude decimalLongitude</span>
<span class="c1">#&gt; 1          Hirundo rustica 1052606227        30.19364         31.10182</span>
<span class="c1">#&gt; 2      Porphyrio porphyrio 1052606578        30.19364         31.10182</span>
<span class="c1">#&gt; 3      Phalacrocorax carbo 1052606608        30.19364         31.10182</span>
<span class="c1">#&gt; 4          Motacilla flava 1052606594        30.19364         31.10182</span>
<span class="c1">#&gt; 5     Plegadis falcinellus 1052606235        30.19364         31.10182</span>
<span class="c1">#&gt; 6         Luscinia svecica 1052606247        30.19364         31.10182</span>
<span class="c1">#&gt; 7        Saxicola rubicola 1052606528        35.01809         25.85227</span>
<span class="c1">#&gt; 8  Rostratula benghalensis 1052606564        30.19364         31.10182</span>
<span class="c1">#&gt; 9             Ceryle rudis 1052606237        30.19364         31.10182</span>
<span class="c1">#&gt; 10      Halcyon smyrnensis 1052606212        30.19364         31.10182</span>
<span class="c1">#&gt; ..                     ...        ...             ...              ...</span>
<span class="c1">#&gt; Variables not shown: issues (chr), datasetKey (chr), publishingOrgKey</span>
<span class="c1">#&gt;      (chr), publishingCountry (chr), protocol (chr), lastCrawled (chr),</span>
<span class="c1">#&gt;      lastParsed (chr), extensions (chr), basisOfRecord (chr), taxonKey</span>
<span class="c1">#&gt;      (int), kingdomKey (int), phylumKey (int), classKey (int), orderKey</span>
<span class="c1">#&gt;      (int), familyKey (int), genusKey (int), speciesKey (int),</span>
<span class="c1">#&gt;      scientificName (chr), kingdom (chr), phylum (chr), order (chr),</span>
<span class="c1">#&gt;      family (chr), genus (chr), species (chr), genericName (chr),</span>
<span class="c1">#&gt;      specificEpithet (chr), taxonRank (chr), dateIdentified (chr), year</span>
<span class="c1">#&gt;      (int), month (int), day (int), eventDate (chr), modified (chr),</span>
<span class="c1">#&gt;      lastInterpreted (chr), references (chr), identifiers (chr), facts</span>
<span class="c1">#&gt;      (chr), relations (chr), geodeticDatum (chr), class (chr), countryCode</span>
<span class="c1">#&gt;      (chr), country (chr), verbatimEventDate (chr),</span>
<span class="c1">#&gt;      http...unknown.org.occurrenceDetails (chr), rights (chr),</span>
<span class="c1">#&gt;      rightsHolder (chr), occurrenceID (chr), collectionCode (chr), taxonID</span>
<span class="c1">#&gt;      (chr), gbifID (chr), institutionCode (chr), catalogNumber (chr),</span>
<span class="c1">#&gt;      datasetName (chr), recordedBy (chr), identifier (chr),</span>
<span class="c1">#&gt;      identificationID (chr), verbatimLocality (chr), occurrenceRemarks</span>
<span class="c1">#&gt;      (chr), locality (chr), identifiedBy (chr), infraspecificEpithet (chr)</span>
</code></pre></div>
<blockquote>
<p>Keep data only with particular issues</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">res <span class="o">%&gt;%</span> occ_issues<span class="p">(</span>cdround<span class="p">)</span>
<span class="c1">#&gt; Records found [972494] </span>
<span class="c1">#&gt; Records returned [15] </span>
<span class="c1">#&gt; No. unique hierarchies [45] </span>
<span class="c1">#&gt; No. media records [16] </span>
<span class="c1">#&gt; Args [geometry=POLYGON((30.1 10.1, 10 20, 20 40, 40 40, 30.1 10.1)),</span>
<span class="c1">#&gt;      limit=50, offset=0, fields=all] </span>
<span class="c1">#&gt; First 10 rows of data</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;                       name        key decimalLatitude decimalLongitude</span>
<span class="c1">#&gt; 1          Hirundo rustica 1052606227        30.19364         31.10182</span>
<span class="c1">#&gt; 2      Porphyrio porphyrio 1052606578        30.19364         31.10182</span>
<span class="c1">#&gt; 3      Phalacrocorax carbo 1052606608        30.19364         31.10182</span>
<span class="c1">#&gt; 4          Motacilla flava 1052606594        30.19364         31.10182</span>
<span class="c1">#&gt; 5     Plegadis falcinellus 1052606235        30.19364         31.10182</span>
<span class="c1">#&gt; 6         Luscinia svecica 1052606247        30.19364         31.10182</span>
<span class="c1">#&gt; 7        Saxicola rubicola 1052606528        35.01809         25.85227</span>
<span class="c1">#&gt; 8  Rostratula benghalensis 1052606564        30.19364         31.10182</span>
<span class="c1">#&gt; 9             Ceryle rudis 1052606237        30.19364         31.10182</span>
<span class="c1">#&gt; 10      Halcyon smyrnensis 1052606212        30.19364         31.10182</span>
<span class="c1">#&gt; ..                     ...        ...             ...              ...</span>
<span class="c1">#&gt; Variables not shown: issues (chr), datasetKey (chr), publishingOrgKey</span>
<span class="c1">#&gt;      (chr), publishingCountry (chr), protocol (chr), lastCrawled (chr),</span>
<span class="c1">#&gt;      lastParsed (chr), extensions (chr), basisOfRecord (chr), taxonKey</span>
<span class="c1">#&gt;      (int), kingdomKey (int), phylumKey (int), classKey (int), orderKey</span>
<span class="c1">#&gt;      (int), familyKey (int), genusKey (int), speciesKey (int),</span>
<span class="c1">#&gt;      scientificName (chr), kingdom (chr), phylum (chr), order (chr),</span>
<span class="c1">#&gt;      family (chr), genus (chr), species (chr), genericName (chr),</span>
<span class="c1">#&gt;      specificEpithet (chr), taxonRank (chr), dateIdentified (chr), year</span>
<span class="c1">#&gt;      (int), month (int), day (int), eventDate (chr), modified (chr),</span>
<span class="c1">#&gt;      lastInterpreted (chr), references (chr), identifiers (chr), facts</span>
<span class="c1">#&gt;      (chr), relations (chr), geodeticDatum (chr), class (chr), countryCode</span>
<span class="c1">#&gt;      (chr), country (chr), verbatimEventDate (chr),</span>
<span class="c1">#&gt;      http...unknown.org.occurrenceDetails (chr), rights (chr),</span>
<span class="c1">#&gt;      rightsHolder (chr), occurrenceID (chr), collectionCode (chr), taxonID</span>
<span class="c1">#&gt;      (chr), gbifID (chr), institutionCode (chr), catalogNumber (chr),</span>
<span class="c1">#&gt;      datasetName (chr), recordedBy (chr), identifier (chr),</span>
<span class="c1">#&gt;      identificationID (chr), verbatimLocality (chr), occurrenceRemarks</span>
<span class="c1">#&gt;      (chr), locality (chr), identifiedBy (chr), infraspecificEpithet (chr)</span>
</code></pre></div>
<blockquote>
<p>Remove data only with certain issues</p>
</blockquote>
<div class="highlight"><pre><code class="language-r" data-lang="r">res <span class="o">%&gt;%</span> occ_issues<span class="p">(</span><span class="o">-</span>mdatunl<span class="p">)</span>
<span class="c1">#&gt; Records found [972494] </span>
<span class="c1">#&gt; Records returned [38] </span>
<span class="c1">#&gt; No. unique hierarchies [45] </span>
<span class="c1">#&gt; No. media records [16] </span>
<span class="c1">#&gt; Args [geometry=POLYGON((30.1 10.1, 10 20, 20 40, 40 40, 30.1 10.1)),</span>
<span class="c1">#&gt;      limit=50, offset=0, fields=all] </span>
<span class="c1">#&gt; First 10 rows of data</span>
<span class="c1">#&gt; </span>
<span class="c1">#&gt;                      name        key decimalLatitude decimalLongitude</span>
<span class="c1">#&gt; 13 Sympetrum fonscolombii 1065585732        35.01809         25.85227</span>
<span class="c1">#&gt; 14        Charadriiformes 1065590820        30.19364         31.10182</span>
<span class="c1">#&gt; 15      Passer domesticus 1065590106        35.01809         25.85227</span>
<span class="c1">#&gt; 16           Alcea setosa 1076770356        33.86317         35.54867</span>
<span class="c1">#&gt; 17      Arbutus andrachne 1076771248        33.86050         35.57142</span>
<span class="c1">#&gt; 18  Aristida caerulescens 1076771339        33.86378         35.56557</span>
<span class="c1">#&gt; 19         Cistus incanus 1076774204        33.89840         35.73811</span>
<span class="c1">#&gt; 20      Clematis cirrhosa 1076774251        33.86050         35.57142</span>
<span class="c1">#&gt; 21      Clematis flammula 1076774254        33.86050         35.57142</span>
<span class="c1">#&gt; 22     Asplenium ceterach 1076773752        33.89840         35.73811</span>
<span class="c1">#&gt; ..                    ...        ...             ...              ...</span>
<span class="c1">#&gt; Variables not shown: issues (chr), datasetKey (chr), publishingOrgKey</span>
<span class="c1">#&gt;      (chr), publishingCountry (chr), protocol (chr), lastCrawled (chr),</span>
<span class="c1">#&gt;      lastParsed (chr), extensions (chr), basisOfRecord (chr), taxonKey</span>
<span class="c1">#&gt;      (int), kingdomKey (int), phylumKey (int), classKey (int), orderKey</span>
<span class="c1">#&gt;      (int), familyKey (int), genusKey (int), speciesKey (int),</span>
<span class="c1">#&gt;      scientificName (chr), kingdom (chr), phylum (chr), order (chr),</span>
<span class="c1">#&gt;      family (chr), genus (chr), species (chr), genericName (chr),</span>
<span class="c1">#&gt;      specificEpithet (chr), taxonRank (chr), dateIdentified (chr), year</span>
<span class="c1">#&gt;      (int), month (int), day (int), eventDate (chr), modified (chr),</span>
<span class="c1">#&gt;      lastInterpreted (chr), references (chr), identifiers (chr), facts</span>
<span class="c1">#&gt;      (chr), relations (chr), geodeticDatum (chr), class (chr), countryCode</span>
<span class="c1">#&gt;      (chr), country (chr), verbatimEventDate (chr),</span>
<span class="c1">#&gt;      http...unknown.org.occurrenceDetails (chr), rights (chr),</span>
<span class="c1">#&gt;      rightsHolder (chr), occurrenceID (chr), collectionCode (chr), taxonID</span>
<span class="c1">#&gt;      (chr), gbifID (chr), institutionCode (chr), catalogNumber (chr),</span>
<span class="c1">#&gt;      datasetName (chr), recordedBy (chr), identifier (chr),</span>
<span class="c1">#&gt;      identificationID (chr), verbatimLocality (chr), occurrenceRemarks</span>
<span class="c1">#&gt;      (chr), locality (chr), identifiedBy (chr), infraspecificEpithet (chr)</span>
</code></pre></div>
<h2>Other things to explore</h2>

<ul>
<li>Maps! We have some basic mapping functionality to help you visualize data</li>
<li>Registry data - there&#39;s a suite of functions to explore data providers to GBIF</li>
<li><code>spocc</code> Explore the R package <code>spocc</code>, where we integrate biodiversity data
from many places, including from GBIF via this package <a href="https://github.com/ropensci/spocc">spocc</a></li>
</ul>

<h2>end</h2>

<blockquote>
<p>That&#39;s it! Thanks for watching...</p>
</blockquote>

</article>


      <footer>
        <p>
          This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/deed.en_US">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
        </p>
      </footer>
    </div>

    <!-- scripts -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/screencasts/public/js/jquery.fitvids.js"></script>
    <script>
      $(document).ready(function(){
        $("article").fitVids();
      });
    </script>
  </body>
  <footer>
  <script type="text/javascript">
    var _gauges = _gauges || [];
    (function() {
      var t   = document.createElement('script');
      t.type  = 'text/javascript';
      t.async = true;
      t.id    = 'gauges-tracker';
      t.setAttribute('data-site-id', '54ef85ebde2e2660bf00e187');
      t.src = '//secure.gaug.es/track.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(t, s);
    })();
  </script>
</footer>

</html>
